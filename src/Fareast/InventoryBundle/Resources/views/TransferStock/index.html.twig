{% extends "CatalystTemplateBundle::base.html.twig" %}
{% import "CatalystTemplateBundle::form.html.twig" as f %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <div class="portlet box blue-hoki">
            <div class="portlet-title">
                <div class="caption">{{list_title}}</div>
            </div>
            <div class="portlet-body form">
                <form method="post" class="form-horizontal">
                    <div class="form-body">
                        <h4 class="form-section">Information</h4>
                        {{ f.group_select('Department Source','dept_source',object.getCode|default(''),2,3,4)}}
                        {{ f.group_select('Department Destination','dept_destn',object.getCode|default(''),2,3,4)}}
                        {{ f.group_textarea('Description','desc', object.getCode|default(''), 4,3,4) }}  

                        <h4 class="form-section">Item Entries</h4>

                        <div>
                            <a id="btn_from_add" href="#entry_form" class="btn green add-field">Add Item</a>
                        </div>                                         

                        <div class="row table-responsive" style="padding-top:10px">
                            <div class="col-md-12">
                                <table class="table table-striped table-bordered table-hover" aria-describedby="list_table_info">
                                    <thead>
                                        <tr>
                                            <th>Category</th>
                                            <th>Type</th>
                                            <th>Item Name</th>
                                            <th>Unit of Measurement</th>
                                            <th>Quantity</th>                                            
                                            <th style="width: 60px"></th>
                                        </tr>
                                    </thead>
                                    <tbody id="from_table">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                     <div class="form-actions fluid">
                        <div class="col-md-9">
                            <button type="submit" class="btn blue">Submit</button>
                            <a href="{{path('feac_inv_transfer_index')}}" class="btn default">Cancel</a>
                        </div>
                    </div>
                </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div id="entry_form" class="modal fade" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form method="post" action="">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                    <h4 id="form_title" class="modal-title"></h4>
                </div>
                <div class="modal-body">
                    <div class="row form-horizontal form">
                        <div class="form-body">
                            {{ f.group_select('Item Category','name', object.getCode|default(''), 0,3,7) }}
                            {{ f.group_select('Item Name','name', object.getCode|default(''), 0,3,7) }}
                            {{ f.group_text('Unit of Measurement','uom', object.getCode|default(''), 3,7) }}
                            {{ f.group_number('Quantity','qty', object.getCode|default(''), 3,7) }}
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" data-dismiss="modal" class="btn default">Close</button>
                    <button id="btn_entry" type="button" class="btn green">Add</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block js %}
<script>
    $(document).ready(function() {
        ComponentsPickers.init();

        var add_button = $(".add-field");
        var wrapper = $("#from_table");
        var field = '<tr>'+
                    '<td> <select class="form-control select2"></select></td>' +
                    '<td> <select class="form-control select2"></select></td>' +                    
                    '<td> <input type="text" class="form-control"></td>' +
                    '<td> <input type="number" class="form-control"></td>' +
                    '<td> <input type="number" class="form-control"></td>' +
                    '<td><a href="javascript:void(0)" class="remove_field btn default btn-xs red-sunglo"><i class="fa fa-minus-circle"></i> Remove</a></td>' +
                    '</tr>';

        $(add_button).click(function(){
            $(wrapper).append(field);
        });


        //remove row
        $(document).on("click",".remove_field", function(e){
            e.preventDefault();            
            var tr = $(this).closest('tr');
            tr.remove();
            return false;
        });
    });
</script>
{% endblock %}